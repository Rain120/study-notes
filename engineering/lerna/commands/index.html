<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/study-notes/blog/rss.xml" title="小超子的笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/study-notes/blog/atom.xml" title="小超子的笔记 Atom Feed"><title data-react-helmet="true">Lerna 命令 | 小超子的笔记</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://rain120.github.io/study-notes//study-notes/engineering/lerna/commands"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-engineering-current"><meta data-react-helmet="true" property="og:title" content="Lerna 命令 | 小超子的笔记"><meta data-react-helmet="true" name="description" content="lerna.json 配置"><meta data-react-helmet="true" property="og:description" content="lerna.json 配置"><link data-react-helmet="true" rel="icon" href="/study-notes/img/chao.png"><link data-react-helmet="true" rel="canonical" href="https://rain120.github.io/study-notes//study-notes/engineering/lerna/commands"><link data-react-helmet="true" rel="alternate" href="https://rain120.github.io/study-notes//study-notes/engineering/lerna/commands" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://rain120.github.io/study-notes//study-notes/engineering/lerna/commands" hreflang="x-default"><link rel="stylesheet" href="/study-notes/assets/css/styles.75bcba7b.css">
<link rel="preload" href="/study-notes/assets/js/runtime~main.ca097f2f.js" as="script">
<link rel="preload" href="/study-notes/assets/js/main.e05092dc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">
          新文章📚 <a href="https://rain120.github.io/study-notes/life/how-to-make-dried-flower">生活杂记 ~ 如何制作干花</a>
          ，欢迎阅读👁👁
        </div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/study-notes/"><div class="navbar__logo"><img src="/study-notes/img/chao.png" alt="小超子的笔记" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/study-notes/img/chao.png" alt="小超子的笔记" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/study-notes/docs/guide">关于</a><a class="navbar__item navbar__link" docid="guide" href="/study-notes/fe/guide">前端</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" docid="guide" href="/study-notes/engineering/guide">工程能力</a><a class="navbar__item navbar__link" href="/study-notes/error-qa/guide">开发问题收集</a><a class="navbar__item navbar__link" href="/study-notes/tools/guide">工具</a><a class="navbar__item navbar__link" docspluginid="resources" href="/study-notes/resources/guide">资源</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" docspluginid="review" href="/study-notes/review/guide">个人总结</a><a class="navbar__item navbar__link" docspluginid="life" href="/study-notes/life/guide">生活杂记</a><a href="https://github.com/rain120/study-notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/study-notes/engineering/guide">Summary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/study-notes/engineering/coding/annotation">Coding</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/study-notes/engineering/git-npm/guide">Git &amp; Npm 相关</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/study-notes/engineering/webpack/build">Webpack</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/study-notes/engineering/docker/docker-install">Docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/study-notes/engineering/lerna/base">Lerna</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/study-notes/engineering/lerna/base">Lerna 入门篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/study-notes/engineering/lerna/commands">Lerna 命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/study-notes/engineering/lerna/quick-start">快速创建Lerna项目</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/study-notes/engineering/lerna/build-cli/1">Lerna 搭建脚手架</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/study-notes/engineering/lerna/faq">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/study-notes/engineering/linux/initial">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/study-notes/engineering/nginx/note">Nginx</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/study-notes/engineering/shell/">Shell</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shell&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lerna 命令</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lernajson-配置">lerna.json 配置<a class="hash-link" href="#lernajson-配置" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-json theme-code-block"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 当前存储库的版本，当为 independent 时，开启独立模式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;independent&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 用于指定运行命令的特定客户端。 可更改为 yarn 或者 cnpm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;npmClient&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;npm&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;useWorkspaces&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 用作包装位置的 glob 数组， 默认为 [&quot;packages/*&quot;], 也可以修改为其他目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;packages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;packages/*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// lerna publish 相关</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;publish&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 忽略不必要的更改发布新版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;ignoreChanges&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;**/*.md&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__tests__&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;allowBranch&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 当消息记录里包含 %s 将会替换为 v1.1.1, 如果是 %v 则直接替换为 1.1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 如果是 independent 模式则会独立更新每个包的版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 具体请查看 [@lerna/json](https://github.com/lerna/lerna/tree/master/commands/version#--message-msg)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;chore(release): publish %s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// lerna run 相关</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;run&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;stream&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// lerna bootstrap 相关</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;bootstrap&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;ignorePrepublish&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;hoist&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 用作提升某些包的 glob 数组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;hoist&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;jest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;typescript&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// changelog 相关配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;changelog&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;repo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rain120/lerna-quick-start&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;labels&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PR: New Feature&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:rocket: New Features&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PR: Breaking Change&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:boom: Breaking Changes&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PR: Bug Fix&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:bug: Bug Fix&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PR: Documentation&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:memo: Documentation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PR: Internal&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:house: Internal&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PR: Underlying Tools&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;:hammer: Underlying Tools&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;cacheDir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.changelog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-全局配置">Lerna 全局配置<a class="hash-link" href="#lerna-全局配置" title="Direct link to heading">​</a></h2><p>通过<code>lerna --help</code>或者官方文档可获取。</p><ul><li><p><code>--loglevel &lt;silent|error|warn|success|info|verbose|silly&gt;</code>: 要报告的日志级别。失败时，所有日志都将写入当前工作目录中的<code>lerna-debug.log</code>。 默认值为 <code>info</code></p></li><li><p><code>--concurrency</code>: <code>Lerna</code> 并行执行任务时要使用多少个线程（默认为逻辑 <code>CPU</code> 内核数）</p></li><li><p><code>--reject-cycles</code>: 循环引用立即报错</p></li><li><p><code>--no-progress</code>: 禁用进度条(在 <code>CI</code> 环境中，情况总是如此)。</p></li><li><p><code>--no-sort</code>: 默认情况下，所有任务都按照拓扑排序的顺序在程序包上执行，该选项可以禁用排序，以最大的并发性以任意顺序执行任务。</p></li><li><p><code>--max-buffer &lt;bytes&gt;</code>: 为每个基础流程调用设置最大缓冲区长度, 当 使用 <code>lerna import</code> 导入具有大量提交的存储库时，可能会出现内置缓冲区长度不足的问题，可以设置该选项解决这个问题</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-过滤器">Lerna 过滤器<a class="hash-link" href="#lerna-过滤器" title="Direct link to heading">​</a></h2><p>用来过滤命令执行时的范围, 详见<a href="https://www.npmjs.com/package/@lerna/filter-options" target="_blank" rel="noopener noreferrer"><code>@lerna/filter-options</code></a>。通过<code>lerna --help</code>或者官方文档可获取。</p><table><thead><tr><th>Filter</th><th>Description</th></tr></thead><tbody><tr><td><code>--scope &lt;glob&gt;</code></td><td>仅包含<code>glob</code>所匹配到的<code>package</code>, 限制 <code>lerna</code> 命令执行范围</td></tr><tr><td><code>--ignore &lt;glob&gt;</code></td><td>排除<code>glob</code>匹配到的<code>package</code></td></tr><tr><td><code>--no-private</code></td><td>排除私有<code>package</code>, 默认是包含的</td></tr><tr><td><code>--since</code></td><td>仅包括自指定<code>[ref]</code>之后已更改的软件包,如果没有传递参考, 则默认为最新标签。</td></tr><tr><td><code>--exclude-dependents</code></td><td>运行命令时排除所有传递依赖项, 使用<code>--since</code>, 将覆盖默认的“更改”算法。</td></tr><tr><td><code>--include-dependents</code></td><td>运行命令时包括所有传递依赖项, 无论<code>--scope</code>, <code>-ignore</code>或<code>--since</code></td></tr><tr><td><code>--include-dependencies</code></td><td>运行命令时包括所有传递依赖项, 无论<code>--scope</code>, <code>-ignore</code>或<code>--since</code></td></tr><tr><td><code>--include-merged-tags</code></td><td>使用<code>--since</code>运行命令时, 包括来自合并分支的标签。</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-init">lerna init<a class="hash-link" href="#lerna-init" title="Direct link to heading">​</a></h2><p>创建一个新的 <code>Lerna</code> 仓库或将现有的仓库升级到<code>Lerna</code>的当前版本。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例">用法实例<a class="hash-link" href="#用法实例" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>生成的目录结构如下</p><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna-repo/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  packages/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lerna.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项">命令选项<a class="hash-link" href="#命令选项" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --exact            在package.json中指定lerna依赖版本而无需插入符号（^）[布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --independent, -i  独立版本包装                                    [布尔]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><code>independent</code>: 使用独立的版本控制模式, 它将会忽略<code>lerna.json</code>中定义的<code>version</code></li><li><code> Fixed/Locked</code> <code>(default) </code>: <code>Fixed</code>模式下, 项目通过单一的版本进行控制。版本号放在项目根目录下的<code>lerna.json</code>文件的<code>version</code>这个字段。当你执行<code> lerna publish</code>, 如果有文件更新, 它将发布新的版本。</li></ul><p><img alt="lerna-init-i.png" src="/study-notes/assets/images/lerna-init-i-df4ec790f7b68a20590c435dfe920baa.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-create-name-loc"><code>lerna create &lt;name&gt; [loc]</code><a class="hash-link" href="#lerna-create-name-loc" title="Direct link to heading">​</a></h2><p>创建一个新的 <code>lerna</code> 管理包</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-1">用法实例<a class="hash-link" href="#用法实例-1" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna create soul-gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna create soul-gem plugins # soul-gem包 生成到 plugins 文件中</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-1">命令选项<a class="hash-link" href="#命令选项-1" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;name&gt;            软件包名称（包括范围）, 必须是本地唯一的_and_公开可用[字符串] [必填]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[loc]             自定义程序包位置, 默认为第一个配置的程序包位置[字串]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --access        使用范围时, 设置publishConfig.access值[选择：“公共”, “受限制”] [默认值：公共]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --bin           程序包具有可执行文件。使用--bin自定义&lt;executabLername&gt; [默认值：&lt;name&gt;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --description   程序包描述[字符串]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dependencies  软件包依赖关系的列表[数组]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --es-module     初始化转译的ES模块</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --homepage      软件包主页, 默认为根的子路径pkg.homepage [字符串]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --keywords      软件包关键字列表[array]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --license       所需的软件包许可证（SPDX标识符）[默认：ISC]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --private       将新软件包设为私有, 从未发布</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --registry      配置软件包的publishConfig.registry [string]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --tag           配置软件包的publishConfig.tag [string]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --yes            跳过所有提示, 接受默认值</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="lerna-create.png" src="/study-notes/assets/images/lerna-create-98aca8d04b36f79c243a300372619b63.png"></p><p><img alt="lerna-create-pkg.png" src="/study-notes/assets/images/lerna-create-pkg-747bdcf0f0c7d567ebe9430af38ed0c7.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-add-packageversion---dev---exact---peer"><code>lerna add &lt;package&gt;[@version] [--dev] [--exact] [--peer]</code><a class="hash-link" href="#lerna-add-packageversion---dev---exact---peer" title="Direct link to heading">​</a></h2><p>向匹配的软件包添加单个依赖项</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-2">用法实例<a class="hash-link" href="#用法实例-2" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># 安装 react 16.8.0 到 packages 所包含的 package 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add react@16.8.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 软件包/前缀-*将module-1软件包添加到“ prefix-”前缀文件夹中的软件包中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add module-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 将module-1安装到module-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add module-1 --scope = module-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在devDependencies中将module-1安装到module-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add module-1 --scope = module-2 --dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在peerDependencies中将module-1安装到module-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add module-1 --scope = module-2 --peer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在module-1以外的所有模块中安装module-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add module-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> # 跳过自动的“ lerna bootstrap”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add module-1 --no-bootstrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在所有模块中安装babel-core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna add babel-core</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-2">命令选项<a class="hash-link" href="#命令选项-2" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">pkg    # 要添加为依赖项的程序包名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> globs  # 匹配的可选软件包目录globs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -D, --dev          保存到devDependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -E, --exact        完全保存版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -P, --peer         保存到peerDependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --registry         将指定的注册表用于所有npm客户端操作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --no-bootstrap     进行更改后, 不要自动链接“ lerna bootstrap”。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-bootstrap">lerna bootstrap<a class="hash-link" href="#lerna-bootstrap" title="Direct link to heading">​</a></h2><p>在当前的<code>Lerna</code>存储库中引导软件包。安装它们的所有依赖性并链接任何交叉依赖性。</p><p><strong>此命令至关重要, 因为它使您可以使用软件包名称, require()就好像软件包已经存在并在您的 node_modules 文件夹中可用一样。</strong></p><p>运行这个命令相当于运行以下命令</p><ul><li><p><code>npm install</code> 每个软件包的所有外部依赖项。</p></li><li><p>将所有 <code>packages</code> 相互依赖的 Lerna 链接在一起。</p></li><li><p><code>npm run prepublish</code> 在所有 <code>bootstrapped</code> 软件包中（除非<code>--ignore-prepublish</code> 通过）。</p></li><li><p><code>npm run prepare</code> 在所有 <code>bootstrapped</code> 软件包中</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-3">用法实例<a class="hash-link" href="#用法实例-3" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna bootstrap</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-3">命令选项<a class="hash-link" href="#命令选项-3" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">--hoist 将 `glob` 匹配的所有依赖想提升至根目录，以便于所有包都可以用，如果选项存在但未给定 `glob`，则默认为 **（提升所有内容）。关于该配置的更多说明即优缺点可以查看 [hoist documentation](https://github.com/lerna/lerna/blob/master/doc/hoist.md)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--nohoist 当和 `--hoist` 同时使用是，构建过程出现异常或者警告将会停止引导</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--ignore-prepublish 不要在引导程序包中运行预发布的生命周期脚本。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--ignore-scripts 不要在自举程序包中运行 _any_ 生命周期脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--npm-clientExecutable 使用其他源(npm, yarn, pnpm, ...)安装依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--registry 指定的 registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--strict 当和 `--hoist` 同时使用是，构建过程出现异常或者警告将会停止引导。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--use-workspaces     数组中的值是 `Lerna` 将操作委托给 `yarn` 的命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--force-local  不管版本范围匹配如何，强制本地同级链接</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--contents 子目录用作任何链接的源。 必须应用于所有软件包。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-import-dir"><code>lerna import &lt;dir&gt;</code><a class="hash-link" href="#lerna-import-dir" title="Direct link to heading">​</a></h2><p>将本地路径<code>&lt;pathToRepo&gt;</code>中的包导入具有提交历史记录的<code>package / &lt;directory-name&gt;</code>中, 将带有提交历史记录的包导入到 <code>monorepo</code> 中。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-4">用法实例<a class="hash-link" href="#用法实例-4" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna import ./</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-4">命令选项<a class="hash-link" href="#命令选项-4" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">dir # 外部git仓库的路径, 该仓库包含一个npm包[必需]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --flatten          当导入具有合并提交的存储库时,导入命令将无法应用所有提交. 用户可以使用此标志来请求导入&quot;flatten&quot;历史,即每次合并提交, 作为单个合并的更改.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --dest             指定输出目录, 默认为 packages 目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --preserve-commit   每个 `git` 提交都有一个作者和一个提交者，`lerna import` 从外部存储库重新创建每个提交，因此提交者将成为当前的 `git` 用户, 这是正确的，但可能是不希望的。 启用此选项将保留原始提交者（和提交日期），以避免此类问题。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -y, --yes          跳过所有确认提示</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-publish">lerna publish<a class="hash-link" href="#lerna-publish" title="Direct link to heading">​</a></h2><p>创建一个新版本的已更新的软件包。提示新版本并更新<code>git</code>和<code>npm</code>上的所有软件包。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-5">用法实例<a class="hash-link" href="#用法实例-5" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-5">命令选项<a class="hash-link" href="#命令选项-5" title="Direct link to heading">​</a></h3><p><code>--npm-tag [tagname]</code>: 使用给定的<code>npm dist-tag</code>发布到<code>npm</code>（默认为最新）。</p><p><code>--canary</code>/ <code>-c</code>: 创建一个<code>canary</code>版本。</p><p><code>--skip-git</code> : 不要运行任何<code>git</code>命令。</p><p><code>--force-publish [packages]</code>: 强制发布指定的软件包（以逗号分隔）或使用的所有软件包 <code>*</code>（跳过<code>git diff</code>检查更改的软件包）。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-version-bump"><code>lerna version [bump]</code><a class="hash-link" href="#lerna-version-bump" title="Direct link to heading">​</a></h2><p>更改 <code>Lerna</code> 管理的包版本</p><p><code>Note</code>: 发布版本前需要 <code>commit</code> 本地的修改。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-6">用法实例<a class="hash-link" href="#用法实例-6" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna version 1.2.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna version [major | minor | patch | premajor | preminor | prepatch | prerelease]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna version // 从prompt 中选择</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-6">命令选项<a class="hash-link" href="#命令选项-6" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">--allow-branch 接受一个 glob 数组, 标记发布版本允许的分支，默认只有 master 分支</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--amend 跳过自动提交</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--conventional-commits 发布一个常规版本的同时 生成 CHANGELOG.md, 该提交方式是直接中版本号发生变化，不支持小版本变化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--conventional-prerelease 强制当前版本为预发布版本，而不是主版本。不添加这个参数， `--conventional-commits` 只会在当前版本是预发布版本 才会默认提交为 预发布</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--conventional-graduate： 强制预发布版本，升级为发布版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--force-publish：跳过检查 lerna checked 和 git diff, 强制发布一个版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--git-remote 替换提交的远端地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--ignore-changes 接受一个 glob 数组，发布版本忽略匹配的文件变动发生的更改。通过`--no-ignore-changes` 完全禁用。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--message, -m &lt;msg&gt; 相当于 git commit -m &lt;msg&gt;, 提交的内容 %s 表示带 v 的版本号， %dv 表示版本号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--no-push 不 push 内容到 git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--no-changelog 使用` --conventional-commits` 时不生成 `CHANGELOG.md` 文件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--no-commit-hooks在提交版本更改时不要运行git commit挂钩。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--no-git-tag-version不提交或标记版本更改。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--preid 在对预发行版本进行版本控制时指定预发行标识符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--sign-git-commit 将 `--gpg-sign` 标志传递给 `git commit`。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--sign-git-tag 将 `--sign` 标志传递给 `git tag`。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--tag-version-prefix 自定义标签前缀。要完全删除，请传递一个空字符串。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-y, --yes 跳过所有确认提示。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-changed">lerna changed<a class="hash-link" href="#lerna-changed" title="Direct link to heading">​</a></h2><p>列出自上一个标记版本以来已更改的本地软件包。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-7">用法实例<a class="hash-link" href="#用法实例-7" title="Direct link to heading">​</a></h3><p>列出自上一个标记版本以来已更改的本地软件包, <code>lerna changed</code> 的输出将是下一个 <code>lerna version</code> 或者 <code>lerna publish</code> 的软件包列表</p><p><strong>Note: <code>lerna.json</code> 配置 <code>lerna publish</code> 和 <code>lerna version</code> 也影响 <code>lerna changed</code>，如<code>command.publish.ignoreChanges</code></strong>。</p><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna changed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-7">命令选项<a class="hash-link" href="#命令选项-7" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --conventional-graduate   检测当前预发布的软件包, 这些软件包将更改为非预发布版本。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --force-publish           在检测到已更改的软件包时始终包括目标软件包, 跳过默认逻辑。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --ignore-changes          当检测到已更改的软件包时, 忽略与glob匹配的文件中的更改。通过--no-ignore-changes完全禁用。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --include-merged-tags     当检测到更改的软件包时, 包括来自合并分支的标签。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">输出选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --json            将信息显示为JSON数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --ndjson          以换行符分隔的JSON显示信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -a, --all         显示通常隐藏的私人软件包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -l, --long        显示扩展信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p, --parseable   显示可解析的输出, 而不是列视图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --toposort        按照目录的拓扑顺序而不是按词法对包进行排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --graph           将依赖关系图显示为JSON格式的邻接表</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>Note</strong></p><ul><li>不支持<a href="https://www.npmjs.com/package/@lerna/filter-options" target="_blank" rel="noopener noreferrer">过滤器选项</a></li><li><code>lerna.json</code>的配置影响了<code>lerna publish</code> 和 <code>lerna version</code>,同时也影响<code>lerna changed</code></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-diff-package">lerna diff <!-- -->[package?]<a class="hash-link" href="#lerna-diff-package" title="Direct link to heading">​</a></h2><p>自上次发行以来, 比较所有软件包或单个软件包。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-8">用法实例<a class="hash-link" href="#用法实例-8" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna diff soul-gem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-8">命令选项<a class="hash-link" href="#命令选项-8" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">--ignore-changes 忽略与glob匹配的文件中的更改。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-run-script">lerna run <!-- -->[script]<a class="hash-link" href="#lerna-run-script" title="Direct link to heading">​</a></h2><p>在包含该脚本的每个软件包中 运行一个<a href="https://docs.npmjs.com/misc/scripts" target="_blank" rel="noopener noreferrer">npm</a>脚本。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-9">用法实例<a class="hash-link" href="#用法实例-9" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna run test</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-9">命令选项<a class="hash-link" href="#命令选项-9" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">--npm-client 可执行文件，用于运行脚本（npm，yarn，pnpm等）。 默认是npm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--stream 以包为前缀的行的流输出。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--parallel 运行脚本，并发无限，流式输出前缀。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--no-bail 尽管给定软件包中的退出非零，仍继续运行脚本。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--no-prefix 不为流输出添加前缀。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--profile 配置文件脚本执行，并将性能配置文件输出到默认位置。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--profile-location 将性能配置文件输出到自定义位置，而不是默认项目根目录。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-link">lerna link<a class="hash-link" href="#lerna-link" title="Direct link to heading">​</a></h2><p>将所有相互依赖的包符号链接在一起</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-10">用法实例<a class="hash-link" href="#用法实例-10" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna link</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-10">命令选项<a class="hash-link" href="#命令选项-10" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">命令：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lerna link convert # 将本地同级版本范围替换为相对文件: 说明符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --force-local 强制本地同级链接, 而不考虑版本范围是否匹配[布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --contents    用作符号链接源的子目录。 必须适用于所有包装</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-list">lerna list<a class="hash-link" href="#lerna-list" title="Direct link to heading">​</a></h2><p>列出当前<code>Lerna</code>存储库中的所有公共软件包。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-11">用法实例<a class="hash-link" href="#用法实例-11" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna ls</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-11">命令选项<a class="hash-link" href="#命令选项-11" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">命令选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --json          将信息显示为JSON数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --ndjson        以换行符分隔的JSON显示信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -a, --all       显示通常隐藏的私人软件包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -l, --long      显示扩展信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p, --parseable 显示可解析的输出, 而不是列视图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --toposort      按照目录的拓扑顺序而不是按词法对包进行排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --graph         将依赖关系图显示为JSON格式的邻接表</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-clean">lerna clean<a class="hash-link" href="#lerna-clean" title="Direct link to heading">​</a></h2><p>从所有软件包中删除 <code>node_modules</code> 目录</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-12">用法实例<a class="hash-link" href="#用法实例-12" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna clean -y</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-12">命令选项<a class="hash-link" href="#命令选项-12" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">-y, --yes  跳过所有确认提示</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-bootstrap-1">lerna bootstrap<a class="hash-link" href="#lerna-bootstrap-1" title="Direct link to heading">​</a></h2><p>将本地软件包链接在一起, 并安装剩余的软件包依赖项</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-13">用法实例<a class="hash-link" href="#用法实例-13" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna bootstrap</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-13">命令选项<a class="hash-link" href="#命令选项-13" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"> --hoist               安装与[glob]匹配到repo root的外部依赖项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --nohoist             不要提升将[glob]匹配到repo root的外部依赖项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --ignore-prepublish   不要在引导程序包中运行预发布的生命周期脚本。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --ignore-scripts      不要在 bootstrap 程序包中运行_any_生命周期脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --npm-client          可执行文件, 用于安装依赖项（npm, yarn, pnpm等）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --registry            将指定的注册表用于所有npm客户端操作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --strict              提升时不允许警告, 因为它会导致更长的 bootstrap 时间和其他 issue。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --use-workspaces      启用与Yarn工作区的集成。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --force-local         强制本地同级链接, 而不考虑版本范围是否匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --contents            用作任何链接源的子目录。必须适用于所有软件包。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="lerna-bootstrap.png" src="/study-notes/assets/images/lerna-bootstrap-60dcadf0444e7de90329623acf93ab8f.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lerna-publish-1">lerna publish<a class="hash-link" href="#lerna-publish-1" title="Direct link to heading">​</a></h2><p>在当前项目中发布软件包。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="用法实例-14">用法实例<a class="hash-link" href="#用法实例-14" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish [bump]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lerna publish --content lib ＃发布每个由Lerna管理的软件包的 `dist` 子文件夹</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>bump: (位置)</strong></p><p>通过显式版本<em>或</em> semver 关键字增加版本</p><ul><li><p>版本</p><ul><li><p><code>major</code></p></li><li><p><code>minor</code></p></li><li><p><code>patch</code></p></li><li><p><code>premajor</code></p></li><li><p><code>preminor</code></p></li><li><p><code>prepatch</code></p></li><li><p><code>prerelease</code></p></li><li><p><code>from-git</code></p></li><li><p><code>from-package</code></p></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="命令选项-14">命令选项<a class="hash-link" href="#命令选项-14" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-sh theme-code-block"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  -c, --canary        每次成功合并后, 使用sha作为标签的一部分发布软件包。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --preid             在发布预发行版本时指定预发行版本标识符。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --contents          指定要发布的子目录，应用于所有 `Lerna` 管理的包含 `package.json` 文件的软件包，程序包生命周期仍将在原始目录中运行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dist-tag          使用指定的npm dist-tag发布软件包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --legacy-auth       旧版Base64编码的用户名和密码。 [弦]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pre-dist-tag      使用指定的npm dist-tag发布预发行软件包。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --git-head          打包tar包时将SHA显式设置为gitHead, 仅在&#x27;from-package&#x27;位置允许。 [弦]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --graph-type        确定程序包层次结构时要使用的依赖项类型。 [任选值：“ all”, “ dependencies”]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --ignore-prepublish 禁用不推荐使用的“预发布”生命周期脚本[布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --ignore-scripts    禁用所有生命周期脚本[布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --otp               提供一次性密码, 用于通过两因素身份验证进行发布。 [弦]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --registry          将指定的注册表用于所有npm客户端操作。 [弦]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --require-scripts   相对于软件包根目录执行./scripts/prepublish.js和./scripts/postpublish.js。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --no-git-reset      发布完成后, 请勿将更改重置为工作树。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --temp-tag          发布时创建一个临时标签。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --no-verify-access  不验证当前npm用户的软件包读写权限。 [布尔]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -y, --yes           跳过所有确认提示。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="参考资料">参考资料<a class="hash-link" href="#参考资料" title="Direct link to heading">​</a></h2><p><a href="https://lerna.js.org/" target="_blank" rel="noopener noreferrer">Lerna 官方文档</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-02-05T08:06:18.000Z">2/5/2022</time></b> by <b>Rain120</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/study-notes/engineering/lerna/base"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lerna 入门篇</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/study-notes/engineering/lerna/quick-start"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">快速创建Lerna项目</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lernajson-配置" class="table-of-contents__link toc-highlight">lerna.json 配置</a></li><li><a href="#lerna-全局配置" class="table-of-contents__link toc-highlight">Lerna 全局配置</a></li><li><a href="#lerna-过滤器" class="table-of-contents__link toc-highlight">Lerna 过滤器</a></li><li><a href="#lerna-init" class="table-of-contents__link toc-highlight">lerna init</a><ul><li><a href="#用法实例" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-create-name-loc" class="table-of-contents__link toc-highlight"><code>lerna create &lt;name&gt; [loc]</code></a><ul><li><a href="#用法实例-1" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-1" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-add-packageversion---dev---exact---peer" class="table-of-contents__link toc-highlight"><code>lerna add &lt;package&gt;[@version] [--dev] [--exact] [--peer]</code></a><ul><li><a href="#用法实例-2" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-2" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-bootstrap" class="table-of-contents__link toc-highlight">lerna bootstrap</a><ul><li><a href="#用法实例-3" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-3" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-import-dir" class="table-of-contents__link toc-highlight"><code>lerna import &lt;dir&gt;</code></a><ul><li><a href="#用法实例-4" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-4" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-publish" class="table-of-contents__link toc-highlight">lerna publish</a><ul><li><a href="#用法实例-5" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-5" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-version-bump" class="table-of-contents__link toc-highlight"><code>lerna version [bump]</code></a><ul><li><a href="#用法实例-6" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-6" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-changed" class="table-of-contents__link toc-highlight">lerna changed</a><ul><li><a href="#用法实例-7" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-7" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-diff-package" class="table-of-contents__link toc-highlight">lerna diff package?</a><ul><li><a href="#用法实例-8" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-8" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-run-script" class="table-of-contents__link toc-highlight">lerna run script</a><ul><li><a href="#用法实例-9" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-9" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-link" class="table-of-contents__link toc-highlight">lerna link</a><ul><li><a href="#用法实例-10" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-10" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-list" class="table-of-contents__link toc-highlight">lerna list</a><ul><li><a href="#用法实例-11" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-11" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-clean" class="table-of-contents__link toc-highlight">lerna clean</a><ul><li><a href="#用法实例-12" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-12" class="table-of-contents__link toc-highlight">命令选项</a></li></ul></li><li><a href="#lerna-bootstrap-1" class="table-of-contents__link toc-highlight">lerna bootstrap</a></li><li><a href="#用法实例-13" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-13" class="table-of-contents__link toc-highlight">命令选项</a></li><li><a href="#lerna-publish-1" class="table-of-contents__link toc-highlight">lerna publish</a></li><li><a href="#用法实例-14" class="table-of-contents__link toc-highlight">用法实例</a></li><li><a href="#命令选项-14" class="table-of-contents__link toc-highlight">命令选项</a></li><li><a href="#参考资料" class="table-of-contents__link toc-highlight">参考资料</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档站点</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/study-notes/docs/guide">关于我</a></li></ul></div><div class="col footer__col"><div class="footer__title">Hot 仓库</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Rain120/study-notes" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Study Notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/Rain120/typescript-guide" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Typescript Guide<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/tinyfe/one-utils" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>One Utils<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/study-notes/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/rain120/study-notes" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022.</div></div></div></footer></div>
<script src="/study-notes/assets/js/runtime~main.ca097f2f.js"></script>
<script src="/study-notes/assets/js/main.e05092dc.js"></script>
</body>
</html>