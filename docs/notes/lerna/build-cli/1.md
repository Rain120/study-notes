#### å‰ç½®å­¦ä¹ 

- [Lerna å…¥é—¨ç¯‡](notes/lerna/base.md)
- [Lerna å‘½ä»¤](notes/lerna/commands.md)

#### TL;DR

ç›´æ¥ä½“éªŒ ğŸ‘‰ğŸ‘‰ğŸ‘‰

```sh

```

[é¡¹ç›®åœ°å€](https://github.com/Rain120/infinity-gems)

#### ç¼˜ç”±

- æµªè´¹å¤§é‡æ—¶é—´å»åˆ›å»ºï¼Œé…ç½®ç›¸åŒç»“æ„çš„é¡¹ç›®
- å­¦ä¹ `lerna`å¤šåŒ…ç®¡ç†
- å­¦ä¹ å¼€å‘è„šæ‰‹æ¶

#### æœŸæœ›

å¾…æ›´æ–°...

#### æŠ€æœ¯é€‰æ‹©

- [lerna](https://github.com/lerna/lerna): å¤šåŒ…ç®¡ç†
- [typescript](https://github.com/microsoft/TypeScript): é™æ€è¯­æ³•æ£€æŸ¥
- [commander](https://github.com/tj/commander.js/): å‘½ä»¤è¡Œå‘½ä»¤è§£æ
- [Inquirer](https://github.com/SBoudrias/Inquirer.js): ç»ˆç«¯äº¤äº’
- [ora](https://github.com/sindresorhus/ora): ç»ˆç«¯åŠ è½½å™¨
- [chalk](https://github.com/chalk/chalk): ç»ˆç«¯å­—ç¬¦ä¸²æ ·å¼

#### åˆ›å»ºé¡¹ç›®

```sh
mkdir infinity-gems && cd infinity-gems

npm i lerna typescript -D

lerna init -i
```

#### ä»£ç æ£€æŸ¥ & æ ¼å¼åŒ– & è§„èŒƒæäº¤

- ä»£ç æ£€æŸ¥

```sh
npm i eslint @typescript-eslint/eslint-plugin @typescript-eslint/parser -D

eslint --init
```

ä¼šæ ¹æ®ä½ çš„é€‰æ‹©ç”Ÿæˆä¸€ä¸ª `eslint`ç›¸å…³çš„é…ç½®æ–‡ä»¶, æˆ‘é€‰æ‹©çš„æ˜¯ `js`æ–‡ä»¶

```js
module.exports = {
  env: {
    browser: true,
    es6: true,
    node: true,
  },
  extends: [
    'standard'
  ],
  globals: {
    Atomics: 'readonly',
    SharedArrayBuffer: 'readonly'
  },
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaVersion: 2018
  },
  plugins: [
    '@typescript-eslint',
  ],
  rules: {
    'no-var': 'error',
    'semi': ['error', 'always'],
    'indent': [ 'error', 2 ],
    'quotes': [ 'error', 'single' ],
    'no-extra-semi': 'error',
    'prettier/prettier': 'error',
    "space-before-function-paren": ["error", {
      "anonymous": "never",
      "named": "never",
      "asyncArrow": "never"
    }],
    "comma-dangle": ["error", {
      "arrays": "always-multiline",
      "exports": "always-multiline",
      "functions": "never",
      "imports": "always-multiline",
      "objects": "always-multiline",
    }]
  }
}

```

ä»¥åŠå¿½ç•¥æ ¼å¼åŒ–çš„æ–‡ä»¶ `.eslintignore `

```
packages/**/**.test.ts
node_modules/
```

é…ç½®ä¸‹ `package.json`ä¸­çš„ `scripts`

```json
{
  "scripts": {
		"eslint": "eslint --fix --color --ext .ts packages/**"
  }
}
```



- æ ¼å¼åŒ–

```sh
npm i  prettier eslint-plugin-prettier -D
```

åœ¨ `eslint`é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä¸‹ `plugins`

```js
module.exports = {
  ...,
  plugins: [
    '@typescript-eslint',
+   'prettier'
  ],
  ...,
}
```

å†åœ¨æ ¹ç›®å½•ä¸‹é…ç½®ä¸€ä¸ª `.prettierrc`æ–‡ä»¶

```
{
  "printWidth": 120,
  "trailingComma": "all",
  "tabWidth": 2,
  "semi": true,
  "bracketSpacing": true,
  "singleQuote": true,
  "arrowParens": "avoid"
}
```

ä»¥åŠå¿½ç•¥æ ¼å¼åŒ–çš„æ–‡ä»¶ `.prettierignore `

```
packages/**/**.test.ts
node_modules/
```

é…ç½®ä¸‹ `package.json`ä¸­çš„ `scripts`

```json
{
  "scripts": {
    "prettier": "prettier --write packages/**/**.ts"
  }
}
```



- æäº¤

```sh
npm i husky @commitlint/cli @commitlint/config-conventional lint-staged -D
```

é…ç½®ä¸‹ `package.json`ä¸­

```json
{
  "scripts": {
    "lint-staged": "lint-staged"
  },
  "lint-staged": {
    "packages/**/**.{ts}": [
      "npm run prettier",
      "npm run eslint",
      "git add"
    ]
  },
  "husky": {
    "hooks": {
      "pre-commit": [
        "lint-staged"
      ],
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
  },
}
```

é…ç½® `commitlint.js`

```js
module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [
      2,
      'always',
      [
        'feat',
        'fix',
        'docs',
        'style',
        'refactor',
        'perf',
        'test',
        'build',
        'ci',
        'chore',
        'revert',
        'config'
      ]
    ],
    'subject-full-stop': [0, 'never'],
    'subject-case': [0, 'never'],
    'header-max-length': [0, 'always', 150]
  }
};

```

#### åˆ›å»º`package`

```sh
lerna create thanos

lerna create thanos
```

ç”Ÿæˆç›®å½•ç»“æ„

```sh
â”œâ”€â”€ .npmignore
â”œâ”€â”€ README.md
â”œâ”€â”€ __tests__
â”‚   â””â”€â”€ power-gem.test.js
â”œâ”€â”€ index.js
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ index.js
â”œâ”€â”€ package.json
```

è‡³æ­¤ï¼Œæˆ‘ä»¬çš„åˆå§‹åŒ–å·¥ä½œå…¨éƒ¨å®Œæˆäº†ã€‚

#### é‡åˆ°çš„é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•

#### å‚è€ƒèµ„æ–™

[vue-cli](https://github.com/vuejs/vue-cli)

[create-react-app](https://github.com/facebook/create-react-app)

