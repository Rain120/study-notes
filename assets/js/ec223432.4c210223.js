"use strict";(self.webpackChunkstudy_notes=self.webpackChunkstudy_notes||[]).push([[7474],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return u}});var o=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=o.createContext({}),d=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=d(e.components);return o.createElement(l.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),m=d(t),u=r,k=m["".concat(l,".").concat(u)]||m[u]||s[u]||a;return t?o.createElement(k,i(i({ref:n},c),{},{components:t})):o.createElement(k,i({ref:n},c))}));function u(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,i=new Array(a);i[0]=m;var p={};for(var l in n)hasOwnProperty.call(n,l)&&(p[l]=n[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,i[1]=p;for(var d=2;d<a;d++)i[d]=t[d];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},59004:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return p},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return c},default:function(){return m}});var o=t(87462),r=t(63366),a=(t(67294),t(3905)),i=["components"],p={},l=void 0,d={unversionedId:"vue/code-review/lifecycle",id:"vue/code-review/lifecycle",isDocsHomePage:!1,title:"lifecycle",description:"\u56de\u5230\u4e0a\u5c42Vue\u6e90\u7801\u5b66\u4e60\u83dc\u5355",source:"@site/fe/vue/code-review/lifecycle.md",sourceDirName:"vue/code-review",slug:"/vue/code-review/lifecycle",permalink:"/study-notes/fe/vue/code-review/lifecycle",tags:[],version:"current",lastUpdatedBy:"Rain120",lastUpdatedAt:1638239169,formattedLastUpdatedAt:"11/30/2021",frontMatter:{},sidebar:"sidebar",previous:{title:"data-driver",permalink:"/study-notes/fe/vue/code-review/data-driver"},next:{title:"responsive-principle",permalink:"/study-notes/fe/vue/code-review/responsive-principle"}},c=[{value:"<strong>\u524d\u7f6e\u77e5\u8bc6</strong>",id:"\u524d\u7f6e\u77e5\u8bc6",children:[],level:4},{value:"\u6ce8\u518c<code>hooks</code>\u94a9\u5b50\u51fd\u6570",id:"\u6ce8\u518chooks\u94a9\u5b50\u51fd\u6570",children:[],level:4},{value:"1. \u5982\u4f55\u8c03\u7528\u751f\u547d\u5468\u671f\u94a9\u5b50\u51fd\u6570<code>callHook</code>",id:"1-\u5982\u4f55\u8c03\u7528\u751f\u547d\u5468\u671f\u94a9\u5b50\u51fd\u6570callhook",children:[],level:4},{value:"2. <code>beforeCreate &amp; created</code>",id:"2-beforecreate--created",children:[],level:4},{value:"4. <code>beforeMount &amp; mounted</code>",id:"4-beforemount--mounted",children:[],level:4},{value:"5. <code>beforeUpdate &amp; updated</code>",id:"5-beforeupdate--updated",children:[],level:4},{value:"6. <code>beforeDestroy &amp; destroyed</code>",id:"6-beforedestroy--destroyed",children:[],level:4}],s={toc:c};function m(e){var n=e.components,p=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},s,p,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/study-notes/fe/vue/code-review/code-review"},"\u56de\u5230\u4e0a\u5c42Vue\u6e90\u7801\u5b66\u4e60\u83dc\u5355")),(0,a.kt)("h4",{id:"\u524d\u7f6e\u77e5\u8bc6"},(0,a.kt)("strong",{parentName:"h4"},"\u524d\u7f6e\u77e5\u8bc6")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/study-notes/fe/vue/vue-lifecycle/vue-lifecycle"},"Vue\u751f\u547d\u5468\u671f\u7b14\u8bb0")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://codesandbox.io/s/y0117q1y41"},"\u6d4b\u8bd5\u4ee3\u7801"))),(0,a.kt)("h4",{id:"\u6ce8\u518chooks\u94a9\u5b50\u51fd\u6570"},"\u6ce8\u518c",(0,a.kt)("inlineCode",{parentName:"h4"},"hooks"),"\u94a9\u5b50\u51fd\u6570"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"path: src/core/vdom/patch.js")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"export function createPatchFunction (backend) {\n  let i, j\n  const cbs = {}\n\n  const { modules, nodeOps } = backend\n\n  for (i = 0; i < hooks.length; ++i) {\n    cbs[hooks[i]] = []\n    for (j = 0; j < modules.length; ++j) {\n      if (isDef(modules[j][hooks[i]])) {\n        cbs[hooks[i]].push(modules[j][hooks[i]])\n      }\n    }\n  }\n  // ...\n}\n")),(0,a.kt)("h4",{id:"1-\u5982\u4f55\u8c03\u7528\u751f\u547d\u5468\u671f\u94a9\u5b50\u51fd\u6570callhook"},"1. \u5982\u4f55\u8c03\u7528\u751f\u547d\u5468\u671f\u94a9\u5b50\u51fd\u6570",(0,a.kt)("inlineCode",{parentName:"h4"},"callHook")),(0,a.kt)("p",null,"\u8def\u5f84: ",(0,a.kt)("inlineCode",{parentName:"p"},"src/core/instance/init.js -> src/core/instance/lifecycle.js")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"export function callHook (vm: Component, hook: string) {\n  // #7573 disable dep collection when invoking lifecycle hooks\n  pushTarget()\n  const handlers = vm.$options[hook]\n  if (handlers) {\n    for (let i = 0, j = handlers.length; i < j; i++) {\n      try {\n        handlers[i].call(vm)\n      } catch (e) {\n        handleError(e, vm, `${hook} hook`)\n      }\n    }\n  }\n  if (vm._hasHookEvent) {\n    vm.$emit('hook:' + hook)\n  }\n  popTarget()\n}\n")),(0,a.kt)("p",null,"\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"Vue init"),"\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u770b\u5230\ud83d\udc47\u4ee3\u7801:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"vm.$options = mergeOptions(\n  resolveConstructorOptions(vm.constructor),\n  options || {},\n  vm\n)\n")),(0,a.kt)("p",null,"\u8fd9\u4e32\u4ee3\u7801\u662f\u4e3a\u4e86\u5c06",(0,a.kt)("inlineCode",{parentName:"p"},"Vue"),"\u5b9e\u4f8b\u5bf9\u8c61\u4e2d\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"options"),"\u5408\u5165\u5230\u6784\u9020\u51fd\u6570\u4e2d"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"vm.$options[hook]"),"\u662f\u53d6\u5230\u5408\u5165",(0,a.kt)("inlineCode",{parentName:"p"},"options"),"\u5f97",(0,a.kt)("inlineCode",{parentName:"p"},"hook"),"\u94a9\u5b50\u51fd\u6570\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"callHook")," \u51fd\u6570\uff0c\u6839\u636e\u4f20\u5165\u7684\u5b57\u7b26\u4e32 ",(0,a.kt)("inlineCode",{parentName:"p"},"hook"),"\uff0c\u53bb\u62ff\u5230 ",(0,a.kt)("inlineCode",{parentName:"p"},"vm.$options[hook]")," \u5bf9\u5e94\u7684\u56de\u8c03\u51fd\u6570\u6570\u7ec4\uff0c\u7136\u540e\u904d\u5386\u6267\u884c\uff0c\u6267\u884c\u7684\u65f6\u5019\u628a ",(0,a.kt)("inlineCode",{parentName:"p"},"vm")," \u4f5c\u4e3a\u51fd\u6570\u6267\u884c\u7684\u4e0a\u4e0b\u6587\u3002"),(0,a.kt)("h4",{id:"2-beforecreate--created"},"2. ",(0,a.kt)("inlineCode",{parentName:"h4"},"beforeCreate & created")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Vue.protoype._init")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"initLifecycle(vm)\ninitEvents(vm)\ninitRender(vm)\ncallHook(vm, 'beforeCreate')\ninitInjections(vm) // resolve injections before data/props\ninitState(vm)\ninitProvide(vm) // resolve provide after data/props\ncallHook(vm, 'created')\n")),(0,a.kt)("p",null,"\u6211\u4eec\u77e5\u9053\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"beforeCreate"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"created"),",\u5728\u8fd9\u4e24\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"hook"),"\u4e4b\u95f4\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"Vue"),"\u5b9e\u4f8b\u4f1a\u8fdb\u884c\u4e8b\u4ef6\u521d\u59cb\u5316, \u914d\u7f6e",(0,a.kt)("inlineCode",{parentName:"p"},"Event"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"watch"),",\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"data"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"props"),",",(0,a.kt)("inlineCode",{parentName:"p"},"computed"),"\u8fdb\u884c\u6570\u636e\u89c2\u6d4b(",(0,a.kt)("inlineCode",{parentName:"p"},"data observer"),")\u3002\u6b64\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"$el"),"\u8fd8\u4e0d\u5b58\u5728\uff0c\u4f46\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"create"),"\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"data"),"\u5c5e\u6027\u5df2\u7ecf\u5b58\u5728\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u7684\u6570\u636e\u4e0d\u4f9d\u8d56",(0,a.kt)("inlineCode",{parentName:"p"},"dom"),"\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"hook"),"\u4e2d\u8fdb\u884c",(0,a.kt)("inlineCode",{parentName:"p"},"API"),"\u6570\u636e\u83b7\u53d6\u3002"),(0,a.kt)("p",null,"\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"create"),"\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"this.$el"),"\u8fd8\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"\uff0c\u6240\u4ee5\u6b64\u5904\u4f1a\u7b49\u5f85",(0,a.kt)("inlineCode",{parentName:"p"},"Vue"),"\u5b9e\u4f8b\u8c03\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"vm.mounted($el)"),"\uff0c\u63a5\u7740\u5224\u65ad\u662f\u5426\u6709",(0,a.kt)("inlineCode",{parentName:"p"},"template"),"\u914d\u7f6e\uff0c\u6709\u5c31\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"template"),"\u4f5c\u4e3a",(0,a.kt)("inlineCode",{parentName:"p"},"render"),"\u51fd\u6570\uff0c\u6ca1\u6709\u5c31\u901a\u8fc7\u7f16\u8f91",(0,a.kt)("inlineCode",{parentName:"p"},"outHTML"),"\u4f5c\u4e3a",(0,a.kt)("inlineCode",{parentName:"p"},"template"),"\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"render"),"\u51fd\u6570\u9009\u9879 > ",(0,a.kt)("inlineCode",{parentName:"p"},"template"),"\u9009\u9879 > ",(0,a.kt)("inlineCode",{parentName:"p"},"outer HTML"),"\u3002\u6b64\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"mounted"),"\u4e2d",(0,a.kt)("inlineCode",{parentName:"p"},"el"),",",(0,a.kt)("inlineCode",{parentName:"p"},"data"),"\u90fd\u5df2\u7ecf\u521d\u59cb\u5316\u4e86\uff0c\u5f53\u6211\u4eec\u7684\u6570\u636e\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"DOM"),"\u6709\u76f8\u5bf9\u5e94\u7684\u4f9d\u8d56\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"hook"),"\u4e0b\u8fdb\u884c\u6570\u636e\u8bf7\u6c42\u3002"),(0,a.kt)("h4",{id:"4-beforemount--mounted"},"4. ",(0,a.kt)("inlineCode",{parentName:"h4"},"beforeMount & mounted")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"lifecycle-1",src:t(97623).Z})),(0,a.kt)("p",null,"\u4ece\u6d4b\u8bd5\u4ee3\u7801\u6211\u4eec\u77e5\u9053\uff0c\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"beforeMount"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"mounted"),"\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0",(0,a.kt)("inlineCode",{parentName:"p"},"boforeMount"),"\u94a9\u5b50\u51fd\u6570\u7684\u6267\u884c\u987a\u5e8f\u662f\u5148\u7236\u540e\u5b50\uff0c\u800c",(0,a.kt)("inlineCode",{parentName:"p"},"mounted"),"\u94a9\u5b50\u51fd\u6570\u7684\u6267\u884c\u987a\u5e8f\u662f\u5148\u5b50\u540e\u7236\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u6211\u4eec\u6765\u4ece\u4ee3\u7801\u4e00\u63a2\u7a76\u7adf\u5427\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"path: src/core/instance/lifecycle.js -> L:134")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"export function mountComponent (\n  vm: Component,\n  el: ?Element,\n  hydrating?: boolean\n): Component {\n  vm.$el = el\n  // ...\n  callHook(vm, 'beforeMount')\n\n  let updateComponent\n  /* istanbul ignore if */\n  if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n    updateComponent = () => {\n      const name = vm._name\n      const id = vm._uid\n      const startTag = `vue-perf-start:${id}`\n      const endTag = `vue-perf-end:${id}`\n\n      mark(startTag)\n      const vnode = vm._render()\n      mark(endTag)\n      measure(`vue ${name} render`, startTag, endTag)\n\n      mark(startTag)\n      vm._update(vnode, hydrating)\n      mark(endTag)\n      measure(`vue ${name} patch`, startTag, endTag)\n    }\n  } else {\n    updateComponent = () => {\n      vm._update(vm._render(), hydrating)\n    }\n  }\n\n  // we set this to vm._watcher inside the watcher's constructor\n  // since the watcher's initial patch may call $forceUpdate (e.g. inside child\n  // component's mounted hook), which relies on vm._watcher being already defined\n  new Watcher(vm, updateComponent, noop, {\n    before () {\n      if (vm._isMounted) {\n        callHook(vm, 'beforeUpdate')\n      }\n    }\n  }, true /* isRenderWatcher */)\n  hydrating = false\n\n  // manually mounted instance, call mounted on self\n  // mounted is called for render-created child components in its inserted hook\n  if (vm.$vnode == null) {\n    vm._isMounted = true\n    callHook(vm, 'mounted')\n  }\n  return vm\n}\n")),(0,a.kt)("p",null,"\u4ece\u4e0a\u8ff0\u4ee3\u7801\uff0c\u6211\u4eec\u770b\u5230\u5728\u6267\u884c",(0,a.kt)("inlineCode",{parentName:"p"},"vm._render"),"\u4e4b\u524d\u8c03\u7528\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"beforeMount"),"\uff0c\u800c\u4e14\u5728\u8c03\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"mounted"),"\u9700\u8981\u6ee1\u8db3",(0,a.kt)("inlineCode",{parentName:"p"},"vm.$vnode == null"),", \u90a3\u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"vm.$vnode"),"\u53c8\u662f\u5728\u4ec0\u4e48\u65f6\u5019\u521d\u59cb\u5316\u7684\u5462\uff1f"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"path: src/core/instance/render.js -> L:18")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"export function initRender (vm: Component) {\n  vm._vnode = null // the root of the child tree\n  vm._staticTrees = null // v-once cached trees\n  const options = vm.$options\n  const parentVnode = vm.$vnode = options._parentVnode // the placeholder node in parent tree\n  const renderContext = parentVnode && parentVnode.context\n  vm.$slots = resolveSlots(options._renderChildren, renderContext)\n  vm.$scopedSlots = emptyObject\n  // bind the createElement fn to this instance\n  // so that we get proper render context inside it.\n  // args order: tag, data, children, normalizationType, alwaysNormalize\n  // internal version is used by render functions compiled from templates\n  vm._c = (a, b, c, d) => createElement(vm, a, b, c, d, false)\n  // normalization is always applied for the public version, used in\n  // user-written render functions.\n  vm.$createElement = (a, b, c, d) => createElement(vm, a, b, c, d, true)\n\n  // $attrs & $listeners are exposed for easier HOC creation.\n  // they need to be reactive so that HOCs using them are always updated\n  const parentData = parentVnode && parentVnode.data\n\n  // ...\n}\n")),(0,a.kt)("p",null,"\u4ece\u4ee3\u7801\u4e2d\u6211\u4eec\u77e5\u9053",(0,a.kt)("inlineCode",{parentName:"p"},"vm.$vnode"),"\u662f\u7236",(0,a.kt)("inlineCode",{parentName:"p"},"DOM"),"\u6811\u4e2d\u7684\u5360\u4f4d\u7b26\u8282\u70b9\uff0c\u8fd9\u8868\u660e\u5f53\u524d",(0,a.kt)("inlineCode",{parentName:"p"},"mounted"),"\u8c03\u7528\u7684\u65f6\u673a\u4e0d\u662f\u5728\u4e00\u6b21\u7ec4\u4ef6\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\uff0c\u800c\u662f\u6211\u4eec\u901a\u8fc7\u5916\u90e8 ",(0,a.kt)("inlineCode",{parentName:"p"},"new Vue")," \u521d\u59cb\u5316\u8fc7\u7a0b\u3002"),(0,a.kt)("p",null,"\u90a3\u4e48\u4ec0\u4e48\u65f6\u5019\u8c03\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"mounted"),"\u94a9\u5b50\u51fd\u6570\u5462\uff1f"),(0,a.kt)("p",null,"\u6211\u4eec\u770b\u5230\u5728\u6267\u884c\u5b8c",(0,a.kt)("inlineCode",{parentName:"p"},"vm._render"),"\u4e4b\u540e\uff0c\u5f53\u524d\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"vm"),"\u8c03\u7528\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"vm._update"),"\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u4e3b\u8981\u662f\u628a",(0,a.kt)("inlineCode",{parentName:"p"},"VNode patch"),"\u6210\u4e00\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"DOM"),", \u4e4b\u540e\u6267\u884c",(0,a.kt)("inlineCode",{parentName:"p"},"invokeInsertHook"),"\u51fd\u6570\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"path: src/core/vdom/patch.js => L:583")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"function invokeInsertHook (vnode, queue, initial) {\n    // delay insert hooks for component root nodes, invoke them after the\n    // element is really inserted\n    if (isTrue(initial) && isDef(vnode.parent)) {\n      vnode.parent.data.pendingInsert = queue\n    } else {\n      for (let i = 0; i < queue.length; ++i) {\n        queue[i].data.hook.insert(queue[i])\n      }\n    }\n  }\n")),(0,a.kt)("p",null,"\u5c06\u94a9\u5b50\u51fd\u6570\u4e00\u6b21\u5b58\u5165",(0,a.kt)("inlineCode",{parentName:"p"},"insertedVnodeQueue"),"\u961f\u5217\u4e2d\uff0c\u5e76\u4e00\u6b21\u8c03\u7528\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"path: src/core/vdom/create-component.js -> L:69")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"insert (vnode: MountedComponentVNode) {\n    const { context, componentInstance } = vnode\n    if (!componentInstance._isMounted) {\n      componentInstance._isMounted = true\n      callHook(componentInstance, 'mounted')\n    }\n  // ...\n  }\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"insertedVnodeQueue"),"\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"function initComponent (vnode, insertedVnodeQueue) {\n    if (isDef(vnode.data.pendingInsert)) {\n      insertedVnodeQueue.push.apply(insertedVnodeQueue, vnode.data.pendingInsert)\n      vnode.data.pendingInsert = null\n    }\n    vnode.elm = vnode.componentInstance.$el\n    if (isPatchable(vnode)) {\n      invokeCreateHooks(vnode, insertedVnodeQueue)\n      setScope(vnode)\n    } else {\n      // empty component root.\n      // skip all element-related modules except for ref (#3455)\n      registerRef(vnode)\n      // make sure to invoke the insert hook\n      insertedVnodeQueue.push(vnode)\n    }\n  }\n")),(0,a.kt)("h4",{id:"5-beforeupdate--updated"},"5. ",(0,a.kt)("inlineCode",{parentName:"h4"},"beforeUpdate & updated")),(0,a.kt)("h4",{id:"6-beforedestroy--destroyed"},"6. ",(0,a.kt)("inlineCode",{parentName:"h4"},"beforeDestroy & destroyed")))}m.isMDXComponent=!0},97623:function(e,n,t){n.Z=t.p+"assets/images/lifecycle-1-8b1bbfb510f6784314995ea54fbfc5b2.png"}}]);